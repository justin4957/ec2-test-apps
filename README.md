# The Digital Detective Agency: A Fictional Investigative Multi-Part Mystery Tracker

An absurdist performance art project that transforms mundane software errors into **episodic detective mysteries** for children, complete with investigative comedy stories, satirical code fixes, musical soundtracks, food blog evidence, and real-time location tracking. Every error is a case. Every case deserves a child detective.

![Mysteries](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExcHJ0bXp4bjBvNzBsZGJscGRyeWJlbnRqZG5ydzZ3YjZxdGw3eDJ2YyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/3o7btPCcdNniyf0ArS/giphy.gif)

<img width="1102" height="556" alt="Detective Dashboard" src="https://github.com/user-attachments/assets/868b4222-e365-4cfd-b1e5-939202afcf91" />

## The Case Files

This application exists as a **fictional investigative agency** that treats every software error as an unsolved mystery requiring:
- ğŸ“š **Investigative Comedy Stories** - Child detectives (Mia & Danny) uncover the "truth" behind each error
- ğŸ¤– **Satirical Evidence** - Over-engineered "solutions" generated by AI
- ğŸµ **Crime Scene Soundtracks** - Curated music from the "Silver Screen Static" playlist
- ğŸ½ï¸ **Photographic Evidence** - Food blog imagery documenting each case
- ğŸ“ **Location Tracking** - Real-time surveillance of error epicenters
- ğŸ’¬ **Witness Testimonies** - SMS-based user notes via Twilio
- ğŸ›ï¸ **Regulatory Investigations** - Perplexity-powered governing body searches

Every ~4.25 minutes, a new case file is generated, logged, and archived in DynamoDB. This is performative fiction masquerading as infrastructure. This is what happens when you give Claude Code API keys and no adult supervision.

![Detective](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbWI0aWF3bnVzamd3YnI4MGh3ZWx6Z2RlcnJ2bHFkbTVxZXljdDBpZSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/l0HlNQ03J5JxX6lva/giphy.gif)

## The Detective Agency Architecture

### ğŸ•µï¸ Case Management System (Error Generator)
The central investigation bureau that:
- Generates new "cases" every 254.75 seconds (configurable)
- Assigns each case a satirical slogan (via OpenAI)
- Commissions investigative stories (via Anthropic Claude Sonnet 4.5)
- Attaches photographic evidence (via Pexels API)
- Selects appropriate crime scene music (via Spotify)
- Documents GIF evidence (via Giphy)

### ğŸ“š The Fiction Department (Anthropic Integration)
**NEW!** Every error spawns a brief investigative comedy story for children featuring:
- **Detective Mia** - The analytical lead investigator
- **Detective Danny** - The comic relief partner
- **Style**: Encyclopedia Brown meets Douglas Adams
- **Format**: 200 words of satirical investigative fiction
- **Integration**: All error elements woven into narrative (error, slogan, song, food)

Example case file:
```
Error: FileNotFoundException: config.yaml not found
Slogan: "Embrace the chaos of missing plans!"
Song: "Under the Bridge" by Red Hot Chili Peppers

Story: "Detective Mia squinted at the robot lying face-down in the cafeteria.
'What happened?' The robot twitched. 'EMBRACE THE CHAOS OF MISSING PLANS!'
it wailed dramatically..."
```

### ğŸ¤– The Evidence Fabrication Lab (DeepSeek Integration)
Generates **satirical code fixes** that are:
- Technically valid but absurdly over-engineered
- Context-aware based on error type
- Full of factory-of-factories patterns
- Quantum observers and philosophical comments
- Deliberately ridiculous "solutions"

### ğŸ“ The Surveillance Hub (Location Tracker)
A password-protected **case file archive** that:
- Displays all cases in chronological order
- Shows investigative stories (collapsible)
- Shows satirical fixes (collapsible)
- Integrates Google Maps for business locations
- Searches governing bodies via Perplexity AI
- Stores everything in DynamoDB
- Auto-refreshes every 10 seconds (without collapsing expanded sections!)

### ğŸµ The Soundtrack Division (Spotify Integration)
Every case gets music from the curated **"Silver Screen Static"** playlist:
- 100+ tracks of alternative nostalgia
- Rock, classic rock, hard rock genres
- Dynamically selected per case
- Spotify links included in case files

### ğŸ›ï¸ The Regulatory Affairs Department (Perplexity Integration)
**NEW!** Searches for governing bodies related to nearby businesses:
- Federal, state, and local regulatory agencies
- Contact information (phone, email, website)
- Jurisdiction and oversight details
- Stored in DynamoDB for case reference

## Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    The Detective Agency HQ                       â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   Case Generator â”‚â”€â”€â”€â”€â”€â”€â”€>â”‚  Slogan Bureau   â”‚              â”‚
â”‚  â”‚  (Error-Gen)     â”‚  POST  â”‚  (OpenAI GPT-4)  â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                                                      â”‚
â”‚           â”‚ Commissions stories & evidence                      â”‚
â”‚           v                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚            Evidence Collection Services                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ Fiction Dept â”‚  â”‚ Fix Lab      â”‚  â”‚ Photo Archiveâ”‚   â”‚  â”‚
â”‚  â”‚  â”‚ (Anthropic)  â”‚  â”‚ (DeepSeek)   â”‚  â”‚ (Pexels)     â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚  â”‚
â”‚  â”‚  â”‚ Music Dept   â”‚  â”‚ GIF Archive  â”‚                      â”‚  â”‚
â”‚  â”‚  â”‚ (Spotify)    â”‚  â”‚ (Giphy)      â”‚                      â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚           â”‚                                                      â”‚
â”‚           â”‚ Complete case file with story                       â”‚
â”‚           v                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Surveillance Hub (Location Tracker)            â”‚ â”‚
â”‚  â”‚                                                             â”‚ â”‚
â”‚  â”‚  - Case file archive (DynamoDB)                            â”‚ â”‚
â”‚  â”‚  - Investigative stories (collapsible)                     â”‚ â”‚
â”‚  â”‚  - Satirical fixes (collapsible)                           â”‚ â”‚
â”‚  â”‚  - Location mapping (Google Maps)                          â”‚ â”‚
â”‚  â”‚  - Governing body database (Perplexity AI)                 â”‚ â”‚
â”‚  â”‚  - Witness testimonies (Twilio SMS)                        â”‚ â”‚
â”‚  â”‚  - Auto-refresh with state preservation                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Features

### ğŸ“š Fictional Investigative Stories
**Powered by Anthropic Claude Sonnet 4.5**

Every error generates a unique children's detective story:
- **Child Detectives**: Mia (analytical) and Danny (comedic)
- **Mystery Format**: "The Case of the [Error Reason]"
- **Style**: Sardonic investigative comedy for ages 8-12
- **Length**: ~200 words of clever wordplay
- **Integration**: All case elements woven into narrative
- **Example**:
  ```
  # The Case of the Vanishing Instructions

  Detective Mia squinted at the robot lying face-down in the cafeteria.
  "What happened?"

  "It was looking for its config.yaml file," explained her partner,
  Danny, munching pizza. "That's basically a robot's instruction manual."

  The robot twitched. "EMBRACE THE CHAOS OF MISSING PLANS!" it wailed.

  They followed a trail of confused robots singing "Under the Bridge"
  to the computer lab. There, they found the janitor mopping.

  "Whoops," he said, pointing to a soaking-wet file folder.
  "Spilled my coffee."

  "So the robots lost their minds because someone spilled coffee?"
  Danny asked.

  "Basically," Mia confirmed.

  The robots, now free to do whatever they wanted, voted unanimously
  to become a boy band.

  **Mystery solved: Sometimes the biggest disasters start with
  the smallest spills.**
  ```

### ğŸ¤– Satirical Evidence
**Powered by DeepSeek Coder**

Each case includes an over-engineered "solution":
```python
def quantum_index_access(arr, index):
    """
    Quantum Observer Pattern: The index both exists and doesn't exist
    until observed. Rules are for the cautious, but we transcend caution.
    """

    class QuantumObserver:
        def __init__(self, arr, index):
            self.arr = arr
            self.index = index
            self.collapsed_reality = None

        def observe(self):
            if 0 <= self.index < len(self.arr):
                self.collapsed_reality = self.arr[self.index]
            else:
                self.collapsed_reality = "IndexError is a social construct"
            return self.collapsed_reality

    observer_factory = lambda: QuantumObserver(arr, index)
    quantum_observer = observer_factory()
    return quantum_observer.observe()
```

### ğŸ¨ Collapsible Case Files
**State preservation across auto-refresh**

The UI features:
- Collapsible investigative story sections
- Collapsible satirical fix sections
- **NEW**: State preserved during 10-second auto-refresh
- Expand sections remain expanded
- Individual state per case file
- Smooth animations with cubic-bezier easing
- Memphis-style gradient design

### ğŸ“ Location-Based Investigations
- Real-time GPS tracking of error locations
- Google Maps integration for nearby businesses
- Business names attached to case files
- Perplexity AI searches for governing bodies
- Regulatory agency contact information
- 24-hour case file retention

### ğŸ’¬ Witness Testimonies
**Twilio SMS Integration**

- Send SMS messages that attach to case files
- User experience notes displayed in UI
- Provides real-world context for errors
- Simple webhook: `/api/twilio/sms`
- Notes stored in DynamoDB

### ğŸµ Crime Scene Soundtracks

Every case includes music from **"Silver Screen Static"** - 100 tracks of alternative nostalgia:

**Featured Tracks:**
- The Killing Moon - Echo & the Bunnymen
- Where Is My Mind? - Pixies
- Under the Milky Way - The Church
- Fade Into You - Mazzy Star
- #1 Crush - Garbage
- There Is a Light That Never Goes Out - The Smiths
- ...and 94 more!

![Music](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbWI0aWF3bnVzamd3YnI4MGh3ZWx6Z2RlcnJ2bHFkbTVxZXljdDBpZSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/l0HlNQ03J5JxX6lva/giphy.gif)

## API Keys Required

The Digital Detective Agency requires credentials from several investigative services:

| Service | Purpose | Cost |
|---------|---------|------|
| **Anthropic Claude** | Children's investigative stories | ~$40/month |
| **OpenAI GPT-4o** | Sardonic slogans | ~$3/month |
| **DeepSeek** | Satirical code fixes | ~$1/month |
| **Spotify** | Crime scene soundtracks | Free |
| **Giphy** | Visual evidence | Free |
| **Pexels** | Food blog photography | Free |
| **Google Maps** | Location services | ~$0.50/month |
| **Perplexity** | Governing body research | ~$0.03/month |

**Total estimated cost: ~$53/month** (see cost breakdown below)

## Cost Analysis

### Monthly Operating Budget

**AWS Infrastructure (17%):**
- EC2 t2.micro: $8.47/month
- EBS 8GB: $0.64/month
- DynamoDB: $0.02/month (storage + requests)
- ECR: $0.12/month (Docker images)
- **Subtotal: $9.25/month**

**AI/API Services (83%):**
- Anthropic (stories): $39.66/month (74% of total!)
- OpenAI (slogans): $3.30/month
- DeepSeek (fixes): $1.13/month
- Google Maps: $0.51/month
- Perplexity: $0.03/month
- Free services: $0 (Spotify, Giphy, Pexels)
- **Subtotal: $44.63/month**

**Total: ~$53.88/month** (or ~$44.72 with AWS Free Tier)

### Cost Optimization Options

1. **Switch to Claude Haiku 4.5** â†’ Save $33/month (83% reduction on story costs)
2. **Increase case interval to 10 minutes** â†’ Save $26/month (60% reduction)
3. **Use AWS Reserved Instances** â†’ Save $5.50/month (after first year)
4. **Only generate stories on weekdays** â†’ Save $11/month (28% reduction)

## Local Testing

### Prerequisites
- Docker & Docker Compose
- API keys (see above)
- AWS credentials (for DynamoDB)

### Quick Start

1. **Set up environment:**
```bash
cd ec2-test-apps
cp .env.ec2.example .env.ec2
# Edit .env.ec2 and add your API keys
```

2. **Run locally with Docker Compose:**
```bash
docker-compose up --build
```

3. **Access the Detective Dashboard:**
```
http://localhost:8081
```

4. **Watch case files generate:**
Check logs to see stories being created every ~4.25 minutes

### Configuration

Environment variables for case generation:

| Variable | Description | Default |
|----------|-------------|---------|
| `ERROR_INTERVAL_SECONDS` | Time between cases | `254.75` |
| `ANTHROPIC_API_KEY` | For children's stories | Required |
| `OPENAI_API_KEY` | For slogans | Falls back if missing |
| `DEEPSEEK_API_KEY` | For satirical fixes | Optional |
| `SPOTIFY_CLIENT_ID` | For music | Optional |
| `SPOTIFY_CLIENT_SECRET` | For music | Optional |
| `GIPHY_API_KEY` | For GIFs | Optional |
| `PEXELS_API_KEY` | For food images | Optional |
| `GOOGLE_MAPS_API_KEY` | For businesses | Optional |
| `PERPLEXITY_API_KEY` | For governing bodies | Optional |
| `TRACKER_PASSWORD` | Dashboard auth | Required |

## EC2 Deployment

### One-Command Deployment

```bash
./deploy-to-ec2.sh
```

This script:
- Loads environment variables from `.env.ec2`
- Logs into ECR
- Pulls latest Docker images
- Stops existing containers
- Starts all services with proper configuration
- Validates deployment

### Manual Deployment

See sections 407-531 in this README for detailed manual deployment instructions.

## Security & Privacy

### Important Notes

- **Fiction First**: All "investigations" are fictional. Errors are randomly generated.
- **Own Devices Only**: Location tracker should only track YOUR devices with consent
- **Password Protected**: Dashboard requires authentication
- **HTTPS Support**: Self-signed certificates for secure access
- **No Public Data**: All case files are private to your deployment
- **DynamoDB Encryption**: Data at rest is encrypted
- **API Key Security**: Never commit `.env.ec2` to git

### Security Improvements

See GitHub Issue #5 for planned migration to AWS Systems Manager Session Manager (eliminates SSH exposure).

### Port Security

Recent security hardening:
- Closed unused ports (80, 3000, 8443, 9090)
- Internal services (7070, 8080) now Docker-network only
- Only public ports: 8081 (HTTP), 8082 (HTTPS), 22 (SSH)

## Troubleshooting

### Stories not generating?
- Check `docker logs error-generator` for Anthropic API errors
- Verify `ANTHROPIC_API_KEY` is set correctly
- Model: `claude-sonnet-4-5-20250929` (current as of 2025)

### Collapsibles collapsing on refresh?
- This was fixed in the latest deployment
- State is now preserved across 10-second auto-refreshes
- Each case maintains independent expand/collapse state

### High costs?
- See "Cost Optimization Options" above
- Consider switching to Claude Haiku 4.5
- Increase `ERROR_INTERVAL_SECONDS` to reduce frequency

### SSH timeout during deployment?
- Your IP may not be in the security group
- Script automatically adds current IP
- Check EC2 security group rules in AWS Console

## The Fiction

This project exists at the intersection of:
- **Performance Art** - Paid infrastructure generating fictional narratives
- **Absurdist Comedy** - Child detectives investigating software errors
- **Technical Demonstration** - Multi-modal AI integration (text, music, images)
- **Experimental Fiction** - Every error is a mini mystery story
- **Educational Project** - Learning AWS, Docker, AI APIs, system integration

It's a detective agency that doesn't solve real crimes. It's a mystery tracker for mysteries that don't exist. It's fiction all the way down. And it costs $53/month to keep running.

This is what happens when you give AI the ability to create fiction and call it "error logging."

![Mystery](https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExcnFxN2duaDJ2dmF4bjJ3NG5ocHFucHZja2hscTB5cGRhY3p4aGtybyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/3oKIPnAiaMCws8nOsE/giphy.gif)

## License

For testing, educational, and fictional investigative purposes only.

---

**Case Status: ACTIVE**
**Next Case File: ~4.25 minutes**
**Total Cases Archived: 1,761+**
**Lead Detectives: Mia & Danny**
**Case Closure Rate: 0% (all mysteries remain delightfully unsolved)**
